# Работа с MQTT

## Настройка MQTT.fx

Самым простым клиентом будет MQTT.fx, его можно скачать с 
https://mqttfx.jensd.de/

После запуска следует нажать на иконку с шестерёнкой для настройки подключения к серверу.

![00_mqtt_options](E:\git\lc_iot\instructions\img\en\00_mqtt_options.png)

![00_mqtt_options2](E:\git\lc_iot\instructions\img\en\00_mqtt_options2.png)

Следует:

1. Добавить новое соединение
2. Указать его название
3. Ввести имя сервера (предоставит инструктор)
4. Ввести порт на сервере (предоставит инструктор)
5. Сгенерировать уникальный ИД клиента
6. Переключиться на ввод логина и пароля![00_mqtt_options3](E:\git\lc_iot\instructions\img\en\00_mqtt_options3.png)

7. Ввести логин (предоставит инструктор)

8. Ввести пароль (предоставит инструктор)

И сохранить изменения нажатием кнопки ОК.

Далее требуется подключиться к серверу нажатием кнопки **Connect**

## Вводная информация про топики

Хороший набор статей по теме: https://www.hivemq.com/tags/mqtt-essentials/



По структуре топиков базовые требования (цитата с https://www.hivemq.com/blog/mqtt-essentials-part-5-mqtt-topics-best-practices/ ):

1. Уровни топиков разделяются с помощью "/"
2. Именем топика может быть любая UTF-8 строка
3. Имя каждого уровня топика должно содержать минимум один символ
4. Имена чувстВиТеЛьНы к РеГисТру
5. "/" тоже может быть именем топика, но это может запутать

Для подписки сразу на несколько топиков можно использовать:

Для одного уровня: **+**

Пример: rtf/groups/+/name

Для любого количества уровней: #

Пример: rtf/**#**

В этом случае Вы будете получать любые сообщения, направленные на любой топик в пределах rtf/*

## Помигать светодиодом по MQTT бесплатно без карточки и смс

![00_mqtt_run](E:\git\lc_iot\instructions\img\en\00_mqtt_run.png)

Для этого достаточно ввести имя топика, указанное в настройках прошивки в значении параметра **mqtt_topic_in**, в текстовое поле написать **0** или **1** и нажать кнопку **Publish**. Остальные настройки менять не надо.

Для контроля можно подписаться на топики, указанные в параметрах **mqtt_topic_heartbeat** и **define mqtt_topic_out** на вкладке Subscribe

![00_mqtt_subscribe](E:\git\lc_iot\instructions\img\en\00_mqtt_subscribe.png)